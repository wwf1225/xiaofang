webpackJsonp([32],{"0bH6":function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("mvHQ"),n=e.n(i),o=e("Dd8w"),r=e.n(o),s={name:"BizRepairRecord",data:function(){return{advanced:!1,dataSource:[],dataSourceDetail:[],pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,hideOnSinglePage:!1,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(a,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+a+" 条记录"}},paginationDetail:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,hideOnSinglePage:!1,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(a,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+a+" 条记录"}},queryParams:{facilityNo:"",facilityLocation:"",maintainName:"",pageSize:"",pageNum:"",statusList:[]},filteredInfo:null,sortedInfo:null,paginationInfo:null,selectedRowKeys:[],selectedRowKeysDetail:[],loading:!1,visibleDetail:!1,loadingDetail:!1,id:""}},computed:{columns:function(){var a=this;return[{title:"序号",customRender:function(t,e,i){return void 0!==a.pagination.current?10*(a.pagination.current-1)+i+1:i+1},width:150,align:"center"},{title:"消防设施编号",dataIndex:"facilityNo",width:360,align:"center"},{title:"消防设施位置",dataIndex:"facilityLocation",width:380,align:"center"},{title:"设施名称",dataIndex:"equipmentName",width:220,align:"center"},{title:"设备编号",dataIndex:"equipmentNo",width:300,align:"center"},{title:"报修原因",dataIndex:"repairCause",scopedSlots:{customRender:"repairCause"},width:350,align:"center"},{title:"状态",dataIndex:"status",width:150,align:"center"},{title:"报修日期",dataIndex:"repairDate",width:150,align:"center"},{title:"维修人",dataIndex:"maintainName",width:150,align:"center"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},width:100,align:"center"}]},columnsDetail:function(){return[{title:"序号",customRender:function(a,t,e){return""+(e+1)},width:150,align:"center"},{title:"报修内容",dataIndex:"checkItem",width:360,align:"center"},{title:"维修进展",dataIndex:"status",width:380,align:"center"}]}},created:function(){this.btnSearch()},methods:{onChange:function(a){!0===a.target.checked?(this.queryParams.statusList[0]=34,this.queryParams.statusList[1]=35):this.queryParams.statusList=[]},showModal:function(a){this.visibleDetail=!0,this.id=a.id,this.getDetailList()},handleOk:function(){this.visibleDetail=!1},onSelectChange:function(a){this.selectedRowKeys=a},onSelectChangeDetail:function(a){this.selectedRowKeysDetail=a},btnReset:function(){this.queryParams.facilityNo="",this.queryParams.facilityLocation="",this.queryParams.maintainName=""},btnAdd:function(){this.$router.push({path:"/business/bizRepairRecordsub",query:{flag:"1"}})},handleTableChange:function(a,t,e){this.paginationInfo=a,this.filteredInfo=t,this.sortedInfo=e,this.btnSearch({sortField:e.field,sortOrder:e.order})},btnSearch:function(){var a=this;this.loading=!0,this.dataSource=[],this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,this.queryParams.pageSize=this.paginationInfo.pageSize,this.queryParams.pageNum=this.paginationInfo.current):(this.queryParams.pageSize=this.pagination.defaultPageSize,this.queryParams.pageNum=this.pagination.defaultCurrent),this.$post("/business/repair-record/findPageRepairRecord",r()({},this.queryParams)).then(function(t){var e=r()({},a.pagination);200===t.data.code?(e.total=t.data.data.total,a.dataSource=t.data.data.list,a.pagination=e):(null===t.data.data&&(e.total=0,a.pagination=e),a.$message.warning(t.data.msg)),a.loading=!1}).catch(function(t){a.loading=!1})},iconEdit:function(a){var t=this;this.loading=!0,this.$get("/business/repair-record/findRepairRecordById/"+a.id).then(function(a){200===a.data.code?t.$router.push({path:"/business/bizRepairRecordsub",query:{flag:"2",data:n()(a.data.data)}}):t.$message.warning(a.data.msg),t.loading=!1}).catch(function(){t.loading=!1})},btnDelete:function(){var a=this;if(a.loading=!0,void 0===a.selectedRowKeys||0===a.selectedRowKeys.length)return a.loading=!1,a.$message.warning("请选择要删除的巡检记录");for(var t=[],e=0;e<a.selectedRowKeys.length;e++)t.push(this.dataSource[a.selectedRowKeys[e]].id);a.$confirm({class:"test",title:"确认要删除吗？",onOk:function(){a.$delete("/business/repair-record/delRepairRecord/"+t).then(function(t){if(200===t.data.code){if(a.selectedRowKeys.length===a.dataSource.length&&1!==a.pagination.current){var e=r()({},a.pagination);e.current=a.pagination.current-1,a.pagination=e}a.btnSearch(),a.$message.success(t.data.msg)}else a.$message.warning(t.data.msg);a.selectedRowKeys=[],a.loading=!1}).catch(function(){a.loading=!1})},onCancel:function(){a.loading=!1}})},getDetailList:function(){var a=this;this.loadingDetail=!0,this.dataSourceDetail=[],this.$get("/business/repair-record/getRepairDetails/"+this.id).then(function(t){200===t.data.code?a.dataSourceDetail=t.data.data:a.$message.warning(t.data.msg),a.loadingDetail=!1}).catch(function(t){a.loadingDetail=!1})}}},l={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[e("div",{class:a.advanced?"search":null},[e("a-form",[e("a-row",[e("a-col",{attrs:{span:6}},[e("a-form-item",{attrs:{label:"设施编号",labelCol:{span:6},wrapperCol:{span:14}}},[e("a-input",{model:{value:a.queryParams.facilityNo,callback:function(t){a.$set(a.queryParams,"facilityNo",t)},expression:"queryParams.facilityNo"}})],1)],1),a._v(" "),e("a-col",{attrs:{span:6}},[e("a-form-item",{attrs:{label:"设施位置",labelCol:{span:6},wrapperCol:{span:14}}},[e("a-input",{model:{value:a.queryParams.facilityLocation,callback:function(t){a.$set(a.queryParams,"facilityLocation",t)},expression:"queryParams.facilityLocation"}})],1)],1),a._v(" "),e("a-col",{attrs:{span:6}},[e("a-form-item",{attrs:{label:"维修人",labelCol:{span:6},wrapperCol:{span:14}}},[e("a-input",{model:{value:a.queryParams.maintainName,callback:function(t){a.$set(a.queryParams,"maintainName",t)},expression:"queryParams.maintainName"}})],1)],1),a._v(" "),e("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e("a-form-item",{attrs:{wrapperCol:{span:24}}},[e("a-button",{attrs:{type:"primary"},on:{click:a.btnSearch}},[a._v("查询")]),a._v(" "),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:a.btnReset}},[a._v("重置")])],1)],1)],1),a._v(" "),e("br"),a._v(" "),e("a-row",[e("a-col",{attrs:{span:24}},[e("a-checkbox",{on:{change:a.onChange}},[a._v("不显示‘已维修’的记录")])],1)],1)],1),a._v(" "),e("br"),a._v(" "),e("div",[e("a-row",[e("a-col",[e("a-button",{on:{click:a.btnAdd}},[a._v("新增")]),a._v(" "),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:a.btnDelete}},[a._v("删除")])],1)],1)],1),a._v(" "),e("br"),a._v(" "),e("div",[e("a-table",{ref:"TableInfo",attrs:{columns:a.columns,dataSource:a.dataSource,pagination:a.pagination,rowSelection:{selectedRowKeys:a.selectedRowKeys,onChange:a.onSelectChange},loading:a.loading,bordered:""},on:{change:a.handleTableChange},scopedSlots:a._u([{key:"repairCause",fn:function(t,i){return[e("a-button",{on:{click:function(t){a.showModal(i)}}},[a._v("详情")])]}},{key:"operation",fn:function(t,i){return[e("a-icon",{attrs:{type:"edit",theme:"twoTone",twoToneColor:"#4a9ff5",title:"编辑"},on:{click:function(t){a.iconEdit(i)}}})]}}])})],1),a._v(" "),e("a-modal",{attrs:{title:"详情",width:"60%"},on:{ok:a.handleOk},model:{value:a.visibleDetail,callback:function(t){a.visibleDetail=t},expression:"visibleDetail"}},[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-table",{attrs:{columns:a.columnsDetail,dataSource:a.dataSourceDetail,pagination:a.paginationDetail,rowSelection:{selectedRowKeys:a.selectedRowKeysDetail,onChange:a.onSelectChangeDetail},loading:a.loadingDetail,bordered:""}})],1)],1)],1)],1)])},staticRenderFns:[]},c=e("VU/8")(s,l,!1,function(a){e("ul7l")},"data-v-2d65f678",null);t.default=c.exports},ul7l:function(a,t){}});